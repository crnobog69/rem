{
  "name": "Remfile",
  "scopeName": "source.remfile",
  "patterns": [
    { "include": "#comments" },
    { "include": "#sectionVars" },
    { "include": "#sectionTask" },
    { "include": "#assignDefault" },
    { "include": "#assignTaskField" },
    { "include": "#assignVar" },
    { "include": "#strings" },
    { "include": "#numbers" },
    { "include": "#bools" },
    { "include": "#shellVars" }
  ],
  "repository": {
    "comments": {
      "patterns": [
        {
          "name": "comment.line.number-sign.remfile",
          "match": "#.*$"
        }
      ]
    },
    "sectionVars": {
      "patterns": [
        {
          "name": "meta.section.remfile",
          "match": "^(\\s*)(\\[)(vars)(\\])(\\s*)$",
          "captures": {
            "2": { "name": "punctuation.definition.brackets.remfile" },
            "3": { "name": "keyword.control.remfile" },
            "4": { "name": "punctuation.definition.brackets.remfile" }
          }
        }
      ]
    },
    "sectionTask": {
      "patterns": [
        {
          "name": "meta.section.remfile",
          "match": "^(\\s*)(\\[)(task)(\\.)([A-Za-z0-9_.-]+)(\\])(\\s*)$",
          "captures": {
            "2": { "name": "punctuation.definition.brackets.remfile" },
            "3": { "name": "keyword.control.remfile" },
            "4": { "name": "punctuation.separator.dot.remfile" },
            "5": { "name": "entity.name.function.remfile" },
            "6": { "name": "punctuation.definition.brackets.remfile" }
          }
        }
      ]
    },
    "assignDefault": {
      "patterns": [
        {
          "name": "meta.assignment.remfile",
          "match": "^(\\s*)(default)(\\s*=\\s*)(.*)$",
          "captures": {
            "2": { "name": "keyword.control.remfile" },
            "3": { "name": "keyword.operator.assignment.remfile" },
            "4": { "name": "string.unquoted.remfile" }
          }
        }
      ]
    },
    "assignTaskField": {
      "patterns": [
        {
          "name": "meta.assignment.remfile",
          "match": "^(\\s*)(desc|deps|inputs|outputs|cmd|cmds|dir)(\\s*=\\s*)(.*)$",
          "captures": {
            "2": { "name": "support.type.property-name.remfile" },
            "3": { "name": "keyword.operator.assignment.remfile" },
            "4": { "name": "string.unquoted.remfile" }
          }
        }
      ]
    },
    "assignVar": {
      "patterns": [
        {
          "name": "meta.assignment.remfile",
          "match": "^(\\s*)([A-Za-z_][A-Za-z0-9_]*)(\\s*=\\s*)(.*)$",
          "captures": {
            "2": { "name": "variable.other.constant.remfile" },
            "3": { "name": "keyword.operator.assignment.remfile" },
            "4": { "name": "string.unquoted.remfile" }
          }
        }
      ]
    },
    "numbers": {
      "patterns": [
        {
          "name": "constant.numeric.remfile",
          "match": "\\b\\d+\\b"
        }
      ]
    },
    "bools": {
      "patterns": [
        {
          "name": "constant.language.boolean.remfile",
          "match": "\\b(true|false)\\b"
        }
      ]
    },
    "strings": {
      "patterns": [
        {
          "name": "string.quoted.double.remfile",
          "begin": "\"",
          "end": "\"",
          "patterns": [
            {
              "name": "constant.character.escape.remfile",
              "match": "\\\\."
            },
            {
              "include": "#shellVars"
            }
          ]
        },
        {
          "name": "string.quoted.single.remfile",
          "begin": "'",
          "end": "'",
          "patterns": [
            {
              "name": "constant.character.escape.remfile",
              "match": "\\\\."
            }
          ]
        }
      ]
    },
    "shellVars": {
      "patterns": [
        {
          "name": "variable.parameter.shell.remfile",
          "match": "\\$\\{[A-Za-z_][A-Za-z0-9_:-]*\\}|\\$[A-Za-z_][A-Za-z0-9_]*"
        }
      ]
    }
  }
}
