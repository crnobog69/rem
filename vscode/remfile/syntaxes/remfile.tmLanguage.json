{
  "name": "Remfile",
  "scopeName": "source.remfile",
  "patterns": [
    {
      "include": "#comments"
    },
    {
      "include": "#tomlSection"
    },
    {
      "include": "#tomlAssign"
    },
    {
      "include": "#defaultStmt"
    },
    {
      "include": "#varStmt"
    },
    {
      "include": "#taskDecl"
    },
    {
      "include": "#fieldAssign"
    },
    {
      "include": "#numbers"
    },
    {
      "include": "#strings"
    },
    {
      "include": "#shellVars"
    }
  ],
  "repository": {
    "comments": {
      "patterns": [
        {
          "name": "comment.line.number-sign.remfile",
          "match": "#.*$"
        }
      ]
    },
    "tomlSection": {
      "patterns": [
        {
          "name": "meta.section.remfile",
          "match": "^(\\s*)\\[(vars)\\]\\s*$",
          "captures": {
            "2": {
              "name": "keyword.control.remfile"
            }
          }
        },
        {
          "name": "meta.section.remfile",
          "match": "^(\\s*)\\[(task)(\\.)([A-Za-z0-9_.-]+)\\]\\s*$",
          "captures": {
            "2": {
              "name": "keyword.control.remfile"
            },
            "4": {
              "name": "entity.name.function.remfile"
            }
          }
        }
      ]
    },
    "tomlAssign": {
      "patterns": [
        {
          "name": "meta.assignment.toml.remfile",
          "match": "^(\\s*)(default|desc|deps|inputs|outputs|cmds|cmd|dir)(\\s*=\\s*)(.*)$",
          "captures": {
            "2": {
              "name": "keyword.control.remfile"
            },
            "3": {
              "name": "keyword.operator.assignment.remfile"
            },
            "4": {
              "name": "string.unquoted.remfile"
            }
          }
        },
        {
          "name": "meta.assignment.toml.remfile",
          "match": "^(\\s*)([A-Za-z_][A-Za-z0-9_]*)(\\s*=\\s*)(.*)$",
          "captures": {
            "2": {
              "name": "variable.other.readwrite.remfile"
            },
            "3": {
              "name": "keyword.operator.assignment.remfile"
            },
            "4": {
              "name": "string.unquoted.remfile"
            }
          }
        }
      ]
    },
    "defaultStmt": {
      "patterns": [
        {
          "name": "meta.default.remfile",
          "match": "^(\\s*)(default)(\\s+)([A-Za-z0-9_.-]+)\\s*$",
          "captures": {
            "2": {
              "name": "keyword.control.remfile"
            },
            "4": {
              "name": "entity.name.function.remfile"
            }
          }
        }
      ]
    },
    "varStmt": {
      "patterns": [
        {
          "name": "meta.var.declaration.remfile",
          "match": "^(\\s*)(var)(\\s+)([A-Za-z_][A-Za-z0-9_]*)(\\s*=\\s*)(.*)$",
          "captures": {
            "2": {
              "name": "storage.type.remfile"
            },
            "4": {
              "name": "variable.other.readwrite.remfile"
            },
            "5": {
              "name": "keyword.operator.assignment.remfile"
            },
            "6": {
              "name": "string.unquoted.remfile"
            }
          }
        }
      ]
    },
    "taskDecl": {
      "patterns": [
        {
          "name": "meta.task.declaration.remfile",
          "match": "^(\\s*)(task)(\\s+)([A-Za-z0-9_.-]+)(:)\\s*$",
          "captures": {
            "2": {
              "name": "keyword.control.remfile"
            },
            "4": {
              "name": "entity.name.function.remfile"
            },
            "5": {
              "name": "punctuation.separator.key-value.remfile"
            }
          }
        }
      ]
    },
    "fieldAssign": {
      "patterns": [
        {
          "name": "meta.field.assignment.remfile",
          "match": "^(\\s*)(desc|deps|inputs|outputs|cmd|run|dir)(\\s*=\\s*)(.*)$",
          "captures": {
            "2": {
              "name": "variable.other.property.remfile"
            },
            "3": {
              "name": "keyword.operator.assignment.remfile"
            },
            "4": {
              "name": "string.unquoted.remfile"
            }
          }
        }
      ]
    },
    "numbers": {
      "patterns": [
        {
          "name": "constant.numeric.remfile",
          "match": "\\b\\d+\\b"
        }
      ]
    },
    "strings": {
      "patterns": [
        {
          "name": "string.quoted.double.remfile",
          "begin": "\"",
          "end": "\"",
          "patterns": [
            {
              "name": "constant.character.escape.remfile",
              "match": "\\\\."
            }
          ]
        },
        {
          "name": "string.quoted.single.remfile",
          "begin": "'",
          "end": "'",
          "patterns": [
            {
              "name": "constant.character.escape.remfile",
              "match": "\\\\."
            }
          ]
        }
      ]
    },
    "shellVars": {
      "patterns": [
        {
          "name": "variable.parameter.shell.remfile",
          "match": "\\$\\{[A-Za-z_][A-Za-z0-9_:-]*\\}|\\$[A-Za-z_][A-Za-z0-9_]*"
        }
      ]
    }
  }
}
